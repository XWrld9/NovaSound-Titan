<!doctype html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
		<link rel="manifest" href="/manifest.json" />
		<meta name="theme-color" content="#06b6d4" />
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<meta name="apple-mobile-web-app-title" content="NovaSound" />
		<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="application-name" content="NovaSound TITAN LUX" />
		<meta name="generator" content="NovaSound TITAN LUX" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
		<title>NovaSound TITAN LUX</title>
	
    <script>
      // ── iOS Email Verification Fix ───────────────────────────────────────
      // Supabase envoie le lien sous la forme :
      //   https://site.com/?token_hash=xxx&type=signup
      // Sur iOS, les query params sont AVANT le #, React (HashRouter) ne les voit pas.
      // Ce script les détecte et redirige vers /#/auth/callback?token_hash=xxx
      (function() {
        try {
          var search = window.location.search;
          if (!search) return;
          var params = new URLSearchParams(search);
          var tokenHash = params.get('token_hash');
          var token     = params.get('token');
          var type      = params.get('type');
          var accessToken = params.get('access_token');
          // Si on a un token de vérification dans les query params → rediriger vers la route callback
          if (tokenHash || token || accessToken) {
            var newHash = '/#/auth/callback' + search;
            window.location.replace(window.location.origin + newHash);
          }
        } catch(e) {}
      })();
    </script>
	</head>
	<body>
		<div id="root"></div>
		<script type="module" src="/src/main.jsx"></script>
		<script>
			if ('serviceWorker' in navigator) {
				window.addEventListener('load', () => {
					navigator.serviceWorker.register('/sw.js').catch(() => {});
				});
			}
		</script>
	</body>
</html>
